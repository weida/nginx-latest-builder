# Nginx 后量子加密 (Post-Quantum Cryptography) 配置示例

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    listen 443 quic reuseport;
    listen [::]:443 quic reuseport;
    
    server_name example.com;
    
    # SSL 证书
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # 启用 TLS 1.3（后量子算法需要）
    ssl_protocols TLSv1.3;
    
    # 后量子密钥交换算法（混合模式）
    # 优先使用后量子算法，回退到传统算法
    ssl_ecdh_curve X25519MLKEM768:X25519:prime256v1;
    
    # 加密套件（TLS 1.3）
    ssl_ciphers TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256;
    ssl_prefer_server_ciphers off;
    
    # HTTP/3 配置
    add_header Alt-Svc 'h3=":443"; ma=86400';
    add_header X-Protocol $server_protocol always;
    
    # 显示使用的加密信息（调试用）
    add_header X-SSL-Cipher $ssl_cipher always;
    add_header X-SSL-Curve $ssl_curve always;
    
    location / {
        root /usr/share/nginx/html;
        index index.html;
    }
}

# HTTP 重定向到 HTTPS
server {
    listen 80;
    listen [::]:80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}
